name: ODGen
description: Run ODGen on your project

inputs:
  root:
    description: The root of the project to analyze.
    required: false
    default: .
  timeout:
    description: The maximum duration of the analysis in seconds.
    required: false
    default: 900 # seconds, 15 minutes

runs:
  using: composite
  steps:
    - shell: bash
      run: echo '::warning::ericcornelissen/odgen-action/all has been deprecated in favor of ericcornelissen/odgen-action with a list of vulnerability types'
    - name: Scan for Path Traversal vulnerabilities
      uses: ericcornelissen/odgen-action@v1.1.0
      with:
        root: ${{inputs.root}}
        timeout: ${{steps.timeout.outputs.value}}
        vulnerability_type: |
          os_command
          code_exec
          proto_pollution
          ipt
          xss
          path_traversal
