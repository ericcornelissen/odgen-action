name: ODGen
description: Run ODGen on your project

inputs:
  root:
    description: The root of the project to analyze.
    required: false
    default: .
  timeout:
    description: The maximum duration of the analysis in seconds.
    required: false
    default: 300 # seconds, 5 minutes

runs:
  using: composite
  steps:
    - name: Scan for Command Injection vulnerabilities
      uses: actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683 # pin@v4
      with:
        root: ${{inputs.root}}
        timeout: ${{inputs.timeout}}
        vulnerability_type: os_command
    - name: Scan for Code Injection vulnerabilities
      uses: actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683 # pin@v4
      with:
        root: ${{inputs.root}}
        timeout: ${{inputs.timeout}}
        vulnerability_type: code_exec
    - name: Scan for Prototype Pollution vulnerabilities
      uses: actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683 # pin@v4
      with:
        root: ${{inputs.root}}
        timeout: ${{inputs.timeout}}
        vulnerability_type: proto_pollution
    - name: Scan for Internal Property Tampering vulnerabilities
      uses: actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683 # pin@v4
      with:
        root: ${{inputs.root}}
        timeout: ${{inputs.timeout}}
        vulnerability_type: ipt
    - name: Scan for Cross-Site Scripting vulnerabilities
      uses: actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683 # pin@v4
      with:
        root: ${{inputs.root}}
        timeout: ${{inputs.timeout}}
        vulnerability_type: xss
    - name: Scan for Path Traversal vulnerabilities
      uses: actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683 # pin@v4
      with:
        root: ${{inputs.root}}
        timeout: ${{inputs.timeout}}
        vulnerability_type: path_traversal
